<template>
<div class="container col-md-8">
    <!-- Title -->
    <div class="form-group mb-4">
        <div class="d-flex justify-content-between" style="width:100%">
            <label class="d-flex notice-title-main mb-0 mr-3">{{notice.title}}</label>
                <div class="d-flex justify-content-end">
                    <small class="form-text notice-title-sub text-muted d-flex mr-2">작성일 : {{writeDate(this.notice.createDate)}}</small>
                    <small class="notice-title-sub">|</small>
                    <small class="form-text notice-title-sub text-muted d-flex ml-2">조회수 : {{notice.visit}}</small>
                </div>
        </div>
    <hr>
    </div>

    <!-- Detail-Info -->
    <div class="form-group">
        <label class="d-flex notice-content-main mr-3">Contents</label>
        <small class="form-text notice-content-sub text-muted d-flex">{{notice.content}}</small>
    </div>

    <!-- Button -->
    <div class="d-flex justify-content-end mb-5 mt-5">
      <button type="submit" class="btn btn-delete pr-0 mr-2" style="font-size: 1.1rem;" @click="noticemodify">
        <i class="far fa-edit mr-2"></i>수정하기
      </button>
      <button type="submit" class="btn btn-delete pr-0 mr-2" style="font-size: 1.1rem;" @click="noticedelete">
        <i class="fas fa-trash-alt mr-2"></i>삭제하기
      </button>
      <button type="submit" class="btn btn-outline pr-0" style="font-size: 1.1rem;" @click="goNotice">
        <i class="fas fa-th-list mr-2"></i>목록으로
      </button>
    </div>
  </div>
</template>

<script>
import axios from 'axios';

import Swal from 'sweetalert2';

const baseURL = 'http://localhost:8080';

export default {
    created(){
        this.init();
    },
    data(){
        return{
            notice:[],
        }
    },
    methods:{
        init() {
          axios
            .get(`${baseURL}/notice/detail/${this.$route.params.ID}`)
            .then((res) => {
                this.notice = res.data;
            })
            .catch((err) => {
            console.log(err);
            });
        },
        writeDate(createDate){
            var wd = this.notice.createDate+"";
            return wd.substring(0,10);
        },
        goNotice() {
            this.$router.push('/notice');
        },
        noticedelete(){
            Swal.fire({
                width: 350,
                text: '글을 삭제하시겠습니까?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: '<a style="font-size:1rem; color:black">Delete</a>',
                cancelButtonText: '<a style="font-size:1rem; color:black">Cancel</a>',
            }).then((result) => {
                if (result.value) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    onOpen: (toast) => {
                    toast.addEventListener('mouseenter', Swal.stopTimer);
                    toast.addEventListener('mouseleave', Swal.resumeTimer);
                    },
                });
                Toast.fire({
                    icon: 'success',
                    title: '글이 삭제되었습니다.',
                });
                axios
                  .delete(`${baseURL}/notice/delete/${this.$route.params.ID}`)
                  .then(()=>{
                    this.$router.push(`/notice/`)
                  })
                  .catch((err)=>{
                    console.log(err)
                  });
                }
            });
        },
        noticemodify(){
            this.$router.push({
                name: 'NoticeUpdate',
                params: { ID: this.$route.params.ID }
            })
        },
    },
}
</script>

<style scoped>
.notice-title-main{
    text-align: left;
    font-size: 1.7rem;
    font-weight: bold;
    max-width: 70%;
}

.notice-title-sub{
    font-size: 1rem;
    max-width: 100%;
    margin-top: auto;
}

.notice-content-main{
    font-size: 1.5rem;
    font-weight: bold;
}

.notice-content-sub{
    text-align: left;
    font-size: 1.2rem;
}
</style>